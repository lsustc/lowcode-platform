(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-446e3cfd"],{"0923":function(t,e,a){"use strict";a("9b1c")},"284f":function(t,e,a){},3855:function(t,e,a){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"editerTags"},[e("span",{staticClass:"tagWarp"},[t._l(t.tags,(function(a,n){return e("el-tag",{key:n,staticClass:"tag",attrs:{closable:!0,"close-transition":!1},on:{close:function(e){return t.handleClose(n,a)}}},[e("i",{staticClass:"ifont icon-tag"}),t._v(t._s(a.name)+"\n    ")])})),t.inputVisible?e("el-autocomplete",{attrs:{size:"mini","value-key":"name","fetch-suggestions":t.querySearchAsync,maxlength:10,minlength:1,placeholder:"请输入内容"},on:{select:t.handleSelect},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm.apply(null,arguments)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):t._e(),t.canAdd&&t.inputBtnVisible?e("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(e){t.inputVisible=!0,t.inputBtnVisible=!1}}},[t._v("+新标签")]):t._e()],2),e("div",[e("h4",[t._v("可快速选标签列表")]),t._l(t.canSelectTags,(function(a,n){return e("el-tag",{key:n,staticClass:"tag",nativeOn:{click:function(e){return t.selectTag(a)}}},[e("i",{staticClass:"ifont icon-tag"}),t._v(t._s(a.name)+"\n    ")])}))],2)])},i=[],o=a("ed03"),r=a("c455"),s={mixins:[o["a"]],name:"UploadImage",components:{},props:{tags:{type:Array,default:function(t){return[]}},categoryId:{type:Number},canAdd:{type:Boolean,default:!1}},data:function(){return{canSelectTags:[],inputVisible:!1,inputBtnVisible:!0,inputValue:""}},watch:{},beforeDestroy:function(){},mounted:function(){this.categoryId&&this.loadTags()},methods:{querySearchAsync:function(t,e){Object(r["a"])({url:"editor/tags/list",data:{categoryId:this.categoryId,name:t},method:"post"}).then((function(t){var a=t.data.data;console.log(a),e(a)})).catch((function(t){}))},handleSelect:function(t){var e=this;this.selectTag(t),this.$nextTick((function(){e.inputValue=""}))},selectTag:function(t){var e=this.tags.find((function(e){if(e.id==t.id)return!0}));e||this.tags.push(t)},loadTags:function(t){var e=this;Object(r["a"])({url:"editor/tags/list",data:{categoryId:this.categoryId,name:""},method:"post"}).then((function(t){var a=t.data.data;e.canSelectTags=a})).catch((function(t){}))},handleInputConfirm:function(){var t=this,e=this.inputValue;e&&Object(r["a"])({url:"editor/tags/add",data:{categoryId:this.categoryId,name:e},method:"post"}).then((function(a){var n=a.data.data;t.selectTag({id:n.id,name:e}),t.inputVisible=!1,t.inputValue="",t.tags.length>2?t.inputBtnVisible=!1:t.inputBtnVisible=!0})).catch((function(e){t.$message("标签添加失败")}))},handleClose:function(t,e){this.tags.splice(this.tags.indexOf(t),1),this.tags.length>2?this.inputBtnVisible=!1:this.inputBtnVisible=!0}}},l=s,c=(a("0923"),a("2877")),u=Object(c["a"])(l,n,i,!1,null,"38bfb3ee",null);e["a"]=u.exports},"66cc":function(t,e,a){"use strict";a("284f")},"6e2a":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"project-edit-container"},[e("div",{staticClass:"project-edit-errors"}),e("div",{staticClass:"row prepend-top-default"},[e("div",{staticClass:"col-lg-3 profile-settings-sidebar"},[e("h4",{staticClass:"prepend-top-0"},[t.id?e("div",[t._v("\n          更新页面\n        ")]):e("div",[t._v("\n          新建页面\n        ")])]),e("div",[t.id?e("div",[t._v("\n          修改自己的页面内容\n        ")]):e("div",[t._v("\n          创建的页面必须在指定的一个组里面，可以自己新建团队\n        ")])])]),e("div",{staticClass:"col-lg-9"},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"图标"}},[e("div",{staticClass:"headIcon"},[e("img",{attrs:{src:t._f("defaultProject")(t.form.image)}})]),e("upload",{attrs:{accept:"image",showBtn:!0,auto:!0},on:{uploadSuccess:t.uploadEnd}})],1),e("el-form-item",{attrs:{label:"所属项目"}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.projectId,callback:function(e){t.$set(t.form,"projectId",e)},expression:"form.projectId"}},t._l(t.myProjects,(function(a){return e("el-option",{key:a.id,attrs:{label:a.groupName+"/"+a.projectName,value:a.id}},[e("span",{staticStyle:{float:"left"}},[t._v(t._s(a.groupName+"/"+a.projectName))])])})),1)],1),e("el-form-item",{attrs:{label:"页面名称",prop:"name",rules:[{required:!0,message:"输入1-35位页面名",trigger:"blur"},{min:1,max:35,message:"长度在 1 到 35 个字符",trigger:"blur"}]}},[e("el-input",{attrs:{placeholder:"页面名称",maxlength:35},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{label:"页面key",prop:"key",rules:[{required:!0,message:"输入1-35位页面名",trigger:"blur"}]}},[e("el-input",{attrs:{placeholder:"页面名称"},model:{value:t.form.key,callback:function(e){t.$set(t.form,"key",e)},expression:"form.key"}})],1),e("el-form-item",{attrs:{label:"描述",prop:"description",rules:[{required:!1,message:"输入描述",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}]}},[e("el-input",{attrs:{type:"textarea",maxlength:50},model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc",e)},expression:"form.desc"}})],1),e("el-form-item",{attrs:{label:"标签"}},[e("tags",{attrs:{"can-add":!0,"category-id":1,tags:t.form.tags},on:{"update:tags":function(e){return t.$set(t.form,"tags",e)}}})],1),e("el-form-item",{attrs:{label:"页面类型"}},[e("el-select",{attrs:{label:"页面类型",placeholder:"请选择"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.pageType,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"设为模板"}},[e("el-radio-group",{model:{value:t.form.visibilitylevel,callback:function(e){t.$set(t.form,"visibilitylevel",e)},expression:"form.visibilitylevel"}},[e("el-radio",{attrs:{label:0}},[t._v("否")]),e("el-radio",{attrs:{label:1}},[t._v("是")])],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v("提交")])],1)],1)],1)])])},i=[],o=a("f458"),r=a("d443"),s=a("c455"),l=a("3855"),c=a("5880");function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function d(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function p(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?d(Object(a),!0).forEach((function(e){m(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function m(t,e,a){return e=f(e),e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function f(t){var e=g(t,"string");return"symbol"===u(e)?e:String(e)}function g(t,e){if("object"!==u(t)||null===t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var n=a.call(t,e||"default");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var y={mixins:[o["a"]],components:{Upload:r["a"],Tags:l["a"]},name:"pages_cnew",props:{id:{type:Number},info:{type:Object}},data:function(){return{loading:!1,myProjects:[],form:{tags:[],id:"",key:"",name:"",type:"0",image:"",desc:"",projectId:"",visibilitylevel:0}}},computed:Object(c["mapState"])({pageType:function(t){return t.Metadata.pageType}}),mounted:function(){this.id&&this.getProjectInfo(),this.getGrops()},methods:{uploadEnd:function(t){this.form.image=t},getProjectInfo:function(){var t=this;Object(s["a"])({url:"editor/pages/info",method:"post",data:{id:this.id+""}}).then((function(e){var a=e.data.data;t.form={id:a.id,key:a.key,image:a.image,type:a.type,desc:a.desc,name:a.name,projectId:a.projectId,visibilitylevel:a.visibilitylevel,tags:a.tags||[]}}))},getGrops:function(){var t=this;Object(s["a"])({url:"project/project",method:"get",needLoading:!0,params:{count:100,start:0}}).then((function(e){var a=e.data.data;t.myProjects=a})).catch((function(){}))},onSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return t.$message("信息填写错误"),!1;t.loading=!0,Object(s["a"])({url:"editor/pages/save",method:"post",data:p({},t.form)}).then((function(e){t.loading=!1,t.$notify({title:"成功",message:"修改成功",type:"success"})})).catch((function(){t.loading=!1,t.$notify({itle:"警告",message:"修改失败",type:"warning"})}))}))}}},h=y,b=(a("66cc"),a("2877")),v=Object(b["a"])(h,n,i,!1,null,"50aa52d7",null);e["default"]=v.exports},"9b1c":function(t,e,a){},d443:function(t,e,a){"use strict";var n=function(){var t=this,e=t._self._c;return e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.showBtn,expression:"showBtn"}],attrs:{size:t.size,id:"virtualUpload",type:"primary"}},[t._v("上传\n  "),e("i",{staticClass:"el-icon-upload el-icon--right"})])},i=[],o=a("e97e"),r=a("46ee"),s=a.n(r),l=a("c455"),c=function(t){Object(l["a"])({url:"upload/getTocken",method:"get",needLoading:!1,data:{}}).then((function(e){var a=e.data.data;t(a)}))},u=function(t){var e=t.id,a=(t.fileName,t.filters),n=t.isAddUploadFile,i=t.callback;this.imgSrc="";var r=!1,l=this,c={image:{title:"资源选择",extensions:"jpg,gif,png,jpeg"},video:{title:"资源选择",extensions:"mp4"},audio:{title:"资源选择",extensions:"mp3"}};this.uploader=new s.a.Uploader({runtimes:"html5",browse_button:e,url:"https://oss.aliyuncs.com",filters:[c[a]],prevent_duplicates:!0,max_file_size:"100mb",init:{PostInit:function(){},FilesAdded:function(t,e){if(r)return!1;r=!0;var a=this,i=e[0].name;if(n){var s=i.lastIndexOf(".");-1!==s&&(i="ymm_"+(new Date).getTime()+i.substring(s)),o["c"].readAsDataURL(e[0].getNative(),(function(t){var n=new window.File([o["c"].getBlobBydataURI(t,e[0].type)],i,{type:e[0].type});a.addFile(n),a.removeFile(e[0]),l.send(i)}))}},BeforeUpload:function(t,e){},UploadProgress:function(t,e){},FileUploaded:function(t,e,a){200===a.status&&(l.imgSrc=l.imgSrc.replace("ymm.oss-cn-hangzhou.aliyuncs.com","imagecdn.ymm56.com"),i(l.imgSrc)),r=!1},Error:function(t,e){}}}),this.uploader.init()};u.prototype.send=function(t){var e=this;t=t||"ymm"+(new Date).getTime()+".png",c((function(a){a.key=a.dir+t,e.imgSrc=a.host+"/"+a.key;var n={key:a.key,policy:a.policy,OSSAccessKeyId:a.accessid,success_action_status:"200",signature:a.signature};console.log("newMultipartParams",n),e.uploader.setOption({url:a.host,multipart_params:n}),e.uploader.start()}))};var d=u,p=a("ed03"),m={mixins:[p["a"]],name:"UploadImage",components:{},props:{h2c:{required:!1,type:Object,default:function(){return{}}},templateElement:{type:String},size:{type:String,default:"medium"},accept:{type:String,default:""},auto:{type:Boolean,default:!1},showBtn:{type:Boolean,default:!1}},data:function(){return{uploadObject:null,options:null,onUploaded:null,templateData:{name:"",desc:""}}},watch:{accept:function(t){var e=this;this.uploadObject=new d({id:this.$el,isAddUploadFile:this.auto,filters:this.accept,callback:function(t){e.$emit("uploadSuccess",t),"function"===typeof e.onUploaded&&e.onUploaded(t)}})}},beforeDestroy:function(){},mounted:function(){var t=this;this.uploadObject=new d({id:this.$el,isAddUploadFile:this.auto,filters:this.accept,callback:function(e){t.$emit("uploadSuccess",e),"function"===typeof t.onUploaded&&t.onUploaded(e)}}),this.ema.bind("saveTemplate",(function(){t.options=null,t.onUploaded=null,t.getImageDataByDom(document.querySelector(t.templateElement),(function(e){t.uploadImg(e)}))}))},methods:{upload:function(t,e,a){var n=this;this.options=e||null,this.onUploaded=a||null,t=t||document.querySelector(this.templateElement),this.getImageDataByDom(t,(function(t){n.uploadImg(t)}))},uploadImg:function(t){var e="ymm"+(new Date).getTime()+".png",a=this,n=new window.File([o["c"].getBlobBydataURI(t,"image/png")],e,{type:"image/png"});a.uploadObject.uploader.addFile(n),a.uploadObject.send()},getImageDataByDom:function(t,e){o["c"].html2canvas(t,this.h2c).then((function(t){var a=t.toDataURL();e&&e(a)}))}}},f=m,g=a("2877"),y=Object(g["a"])(f,n,i,!1,null,"2bff0db8",null);e["a"]=y.exports}}]);