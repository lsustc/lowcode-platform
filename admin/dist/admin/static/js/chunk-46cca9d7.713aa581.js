(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46cca9d7","chunk-04cdda1c","chunk-ed037116","chunk-314c59f2"],{"0780":function(t,e,r){},2480:function(t,e,r){"use strict";r("9456")},"24cc":function(t,e,r){},"2e38":function(t,e,r){"use strict";r("0780")},"46f4":function(t,e,r){},"472b":function(t,e,r){"use strict";r("24cc")},"75e0":function(t,e,r){"use strict";r("46f4")},8447:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t._self._c;return e("div",[e("hr"),e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"图标"}},[e("div",{staticClass:"headIcon"},[e("img",{attrs:{src:t._f("defaultGroup")(t.form.logo)}})]),e("upload",{attrs:{accept:"image",showBtn:!0,auto:!0},on:{uploadSuccess:t.uploadEnd}}),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])],1),e("el-form-item",{attrs:{label:"名称",prop:"name",rules:[{required:!0,message:"输入1-10位组名",trigger:"blur"},{min:1,max:15,message:"长度在 1 到 15 个字符",trigger:"blur"}]}},[e("el-input",{attrs:{placeholder:"名称",maxlength:15},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{label:"描述",prop:"description",rules:[{required:!0,message:"输入描述",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}]}},[e("el-input",{attrs:{type:"textarea",maxlength:50},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),e("div",{staticClass:"form-group"},[e("div",{staticClass:"col-sm-offset-2 col-sm-10"})]),e("el-form-item",[t.id?e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("立即修改")]):e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("立即创建")])],1)],1)],1)},a=[],o=r("f458"),i=r("c455"),s=r("d443"),l={mixins:[o["a"]],components:{Upload:s["a"]},name:"groups_cnew",props:{id:"",onSuccess:{type:Function,default:function(){}}},data:function(){return{info:{},form:{logo:"",name:"",description:""}}},mounted:function(){var t=this;this.id&&Object(i["a"])({url:"project/groupinfo",method:"get",params:{id:this.id}}).then((function(e){t.info=e.data.data,t.form.logo=t.info.logo,t.form.name=t.info.name,t.form.description=t.info.description}))},methods:{uploadEnd:function(t){this.form.logo=t},onSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return t.$message("信息填写错误"),!1;if(t.info.id){var r={logo:t.form.logo,name:t.form.name,description:t.form.description,id:t.info.id};Object(i["a"])({url:"project/group",method:"put",data:r}).then((function(e){t.$message("修改成功"),t.onSuccess(e.data.data)})).catch((function(){t.$message("修改失败"),t.onSuccess()}))}else Object(i["a"])({url:"project/group",method:"post",data:t.form}).then((function(e){t.$message("添加成功"),t.onSuccess(e.data.data)})).catch((function(){t.onSuccess(),t.$message("添加失败")}))}))}}},c=l,u=(r("472b"),r("2877")),d=Object(u["a"])(c,n,a,!1,null,"0fde7920",null);e["default"]=d.exports},"85e6":function(t,e){t.exports="<ol>\n<li>所有项目都会在一个项目组里面。</li>\n<li>每个人在组里面有不同的权限\n 创建者: 可以管理组里面的人和组的基本信息，并且在该组的项目里面有管理员的权限\n 管理员: 在该组项目中有管理员权限\n 开发者: 在该组项目中有开发者权限</li>\n</ol>\n"},"8f20":function(t,e,r){"use strict";var n=function(){var t=this,e=t._self._c;return e("li",{staticClass:"select2-results-dept-0 select2-result select2-result-selectable",attrs:{role:"presentation"}},[e("div",{staticClass:"select2-result-label",attrs:{id:"select2-result-label-25",role:"option"}},[e("div",{staticClass:"user-result undefined"},[e("div",{staticClass:"user-image"},[e("img",{staticClass:"avatar s24",attrs:{src:t.item.photo}})]),e("div",{staticClass:"user-name"},[t._v(t._s(t.item.name))])])])])},a=[],o={mixins:[],name:"CUser_Item",props:{item:Object,default:function(){return{name:"",email:"",photo:""}}},data:function(){return{}},methods:{}},i=o,s=(r("2e38"),r("2877")),l=Object(s["a"])(i,n,a,!1,null,"f1fa7018",null);e["a"]=l.exports},9456:function(t,e,r){},"9ac9":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-fluid container-limited"},[e("div",{staticClass:"content"},[e("div",{staticClass:"project-members-page prepend-top-default"},[e("div",{staticClass:"panel panel-default"},[e("div",{staticClass:"panel-heading"},[t._v("\n          数据\n        ")]),e("div",{staticClass:"panel-body"},[e("el-row",[e("el-col",{attrs:{span:24}},[e("el-form",{ref:"form",attrs:{inline:!0,model:t.form,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"时间范围"}},[e("el-date-picker",{attrs:{type:"daterange","picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:t.form.timeRange,callback:function(e){t.$set(t.form,"timeRange",e)},expression:"form.timeRange"}})],1),e("el-form-item",{attrs:{label:"聚合时间"}},[e("el-radio-group",{model:{value:t.form.step,callback:function(e){t.$set(t.form,"step",e)},expression:"form.step"}},t._l(t.steps,(function(r){return e("el-radio",{key:r.id,attrs:{label:r.id}},[t._v(t._s(r.label||r.id))])})),1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.getPUVTrendByES}},[t._v("查询")])],1)],1)],1)],1),e("el-row",[e("el-card",[e("div",[t._v("\n                共计 "+t._s(t.sumData.projectCount)+" 个项目， "+t._s(t.sumData.pageCount)+" 个页面，累计访客 "+t._s(t.sumData.user)+" 位\n              ")])])],1),e("el-row",{staticStyle:{"margin-top":"10px"}},[e("el-card",[e("div",{attrs:{slot:"header"},slot:"header"},[t._v("\n                PU / UV "),e("i",{staticClass:"chart-hint"},[t._v("点击图例可显示/隐藏对应指标")])]),e("el-col",{ref:"puvchart",attrs:{span:24}},[t.trend.x?e("chart",{staticClass:"mchart",staticStyle:{width:"100%",height:"400px"},attrs:{options:t.trendOptions}}):t._e()],1),e("el-col",{staticStyle:{"padding-bottom":"20px"},attrs:{span:24}},[t.trendTable?e("table",{staticClass:"trend-table"},[e("thead",t._l(t.trendTable.thead,(function(r){return e("th",{key:r},[t._v(t._s(r))])})),0),e("tbody",t._l(t.trendTable.tbody,(function(r,n){return e("tr",{key:n},t._l(r,(function(r,n){return e("td",{key:n},[t._v(t._s(r))])})),0)})),0)]):t._e()])],1)],1)],1)])])])])},a=[],o=r("f458"),i=r("c455"),s=r("907d"),l=r("2651"),c=r.n(l);r("ef97");function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function d(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */d=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(L){l=function(t,e,r){return t[e]=r}}function c(t,e,r,a){var o=e&&e.prototype instanceof m?e:m,i=Object.create(o.prototype),s=new O(a||[]);return n(i,"_invoke",{value:j(t,r,s)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(L){return{type:"throw",arg:L}}}t.wrap=c;var f={};function m(){}function h(){}function v(){}var g={};l(g,o,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(S([])));b&&b!==e&&r.call(b,o)&&(g=b);var _=v.prototype=m.prototype=Object.create(g);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function a(n,o,i,s){var l=p(t[n],t,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==u(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){a("next",t,i,s)}),(function(t){a("throw",t,i,s)})):e.resolve(d).then((function(t){c.value=t,i(c)}),(function(t){return a("throw",t,i,s)}))}s(l.arg)}var o;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){a(t,r,e,n)}))}return o=o?o.then(n,n):n()}})}function j(t,e,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return D()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var s=x(i,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=p(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function x(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var a=p(n,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,f;var o=a.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function S(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:D}}function D(){return{value:void 0,done:!0}}return h.prototype=v,n(_,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:h,configurable:!0}),h.displayName=l(v,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,s,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},w(C.prototype),l(C.prototype,i,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new C(c(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(_),l(_,s,"Generator"),l(_,o,(function(){return this})),l(_,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=S,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),I(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var a=n.arg;I(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:S(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function p(t,e,r,n,a,o,i){try{var s=t[o](i),l=s.value}catch(c){return void r(c)}s.done?e(l):Promise.resolve(l).then(n,a)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function i(t){p(o,n,a,i,s,"next",t)}function s(t){p(o,n,a,i,s,"throw",t)}i(void 0)}))}}function m(t,e){return b(t)||y(t,e)||v(t,e)||h()}function h(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(t,e){if(t){if("string"===typeof t)return g(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(t,e):void 0}}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function y(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,a,o,i,s=[],l=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return s}}function b(t){if(Array.isArray(t))return t}var _={mixins:[o["a"]],components:{chart:c.a},name:"group_data",data:function(){return{now:new Date,pickerOptions:{shortcuts:[["今天",0],["最近一周",6],["最近一月",30]].map((function(t){var e=m(t,2),r=e[0],n=e[1];return{text:r,onClick:function(t){var e=new Date,r=new Date;r.setTime(r-(864e5*n+36e5*r.getHours()+6e4*r.getMinutes()+1e3*r.getSeconds())),t.$emit("pick",[r,e])}}})),disabledDate:function(t){return t>Date.now()}},steps:[{id:"hour",label:"1小时"},{id:"day",label:"1天"}],form:{timeRange:function(){var t=Date.now();return[new Date(t-(t+288e5)%864e5-5184e5),new Date]}(),step:"day"},trend:{},sumData:{pv:null,uv:null,user:null,pageCount:null,projectCount:null}}},watch:{"form.timeRange":{deep:!0,immediate:!0,handler:function(t){t&&t[1]-t[0]>864e5&&"day"!==this.form.step?this.form.step="day":t&&t[1]-t[0]<=864e5&&"hour"!==this.form.step?this.form.step="hour":this.getPUVTrendByES()}},"form.step":function(){this.getPUVTrendByES()}},props:{groupId:{type:[String,Number]}},mounted:function(){},computed:{trendOptions:function(){var t=this.trend.x;return t?Object(s["a"])({title:"  ",dataZoom:!1,seriesNames:["PV","UV"],legendAlign:"left",x:t,y:[this.trend.pv,this.trend.uv]}):{}},trendTable:function(){var t=this,e=this.trend;if(!e||!e.x||!e.x.length)return null;var r=Object.keys(e).filter((function(t){return"x"!==t}));r.unshift("x");var n=r.slice(0);n[0]="时间";var a=e.x.map((function(t,n){return r.map((function(t){return(e[t]||[])[n]||0}))}));return a.push(r.map((function(e){return"x"==e?"总计":t.sumData[e]||0}))),{thead:n,tbody:a}}},methods:{getPUVTrendByES:function(){var t=f(d().mark((function t(){var e,r,n,a;return d().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this,r={groupId:+e.groupId,timePeriod:e.form.timeRange.map((function(t){return t.getTime&&t.getTime()||0})),interval:e.form.step},t.next=4,Object(i["a"])({url:"statistics/getGroupReport",method:"post",data:r}).then((function(t){var e=t.data;return e.data||{}})).catch((function(t){return console.error(t),{histogram:[]}}));case 4:n=t.sent,a=n.histogram.sort((function(t,e){return t.date>e.date?1:-1})).reduce((function(t,e){return t.x.push(new Date(e.date).Format("yyyy-MM-dd hh:mm:ss")),t.pv.push(e.pv),t.uv.push(e.uv),t}),{x:[],pv:[],uv:[]}),this.sumData["pv"]=n.sum.pv,this.sumData["uv"]=n.sum.uv,this.sumData["user"]=n.sum.user,this.sumData["pageCount"]=n.pageCount,this.sumData["projectCount"]=n.projectCount,this.trend=a;case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},w=_,C=(r("75e0"),r("2877")),j=Object(C["a"])(w,n,a,!1,null,"35fa9e60",null);e["default"]=j.exports},d443:function(t,e,r){"use strict";var n=function(){var t=this,e=t._self._c;return e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.showBtn,expression:"showBtn"}],attrs:{size:t.size,id:"virtualUpload",type:"primary"}},[t._v("上传\n  "),e("i",{staticClass:"el-icon-upload el-icon--right"})])},a=[],o=r("e97e"),i=r("46ee"),s=r.n(i),l=r("c455"),c=function(t){Object(l["a"])({url:"upload/getTocken",method:"get",needLoading:!1,data:{}}).then((function(e){var r=e.data.data;t(r)}))},u=function(t){var e=t.id,r=(t.fileName,t.filters),n=t.isAddUploadFile,a=t.callback;this.imgSrc="";var i=!1,l=this,c={image:{title:"资源选择",extensions:"jpg,gif,png,jpeg"},video:{title:"资源选择",extensions:"mp4"},audio:{title:"资源选择",extensions:"mp3"}};this.uploader=new s.a.Uploader({runtimes:"html5",browse_button:e,url:"https://oss.aliyuncs.com",filters:[c[r]],prevent_duplicates:!0,max_file_size:"100mb",init:{PostInit:function(){},FilesAdded:function(t,e){if(i)return!1;i=!0;var r=this,a=e[0].name;if(n){var s=a.lastIndexOf(".");-1!==s&&(a="ymm_"+(new Date).getTime()+a.substring(s)),o["c"].readAsDataURL(e[0].getNative(),(function(t){var n=new window.File([o["c"].getBlobBydataURI(t,e[0].type)],a,{type:e[0].type});r.addFile(n),r.removeFile(e[0]),l.send(a)}))}},BeforeUpload:function(t,e){},UploadProgress:function(t,e){},FileUploaded:function(t,e,r){200===r.status&&(l.imgSrc=l.imgSrc.replace("ymm.oss-cn-hangzhou.aliyuncs.com","imagecdn.ymm56.com"),a(l.imgSrc)),i=!1},Error:function(t,e){}}}),this.uploader.init()};u.prototype.send=function(t){var e=this;t=t||"ymm"+(new Date).getTime()+".png",c((function(r){r.key=r.dir+t,e.imgSrc=r.host+"/"+r.key;var n={key:r.key,policy:r.policy,OSSAccessKeyId:r.accessid,success_action_status:"200",signature:r.signature};console.log("newMultipartParams",n),e.uploader.setOption({url:r.host,multipart_params:n}),e.uploader.start()}))};var d=u,p=r("ed03"),f={mixins:[p["a"]],name:"UploadImage",components:{},props:{h2c:{required:!1,type:Object,default:function(){return{}}},templateElement:{type:String},size:{type:String,default:"medium"},accept:{type:String,default:""},auto:{type:Boolean,default:!1},showBtn:{type:Boolean,default:!1}},data:function(){return{uploadObject:null,options:null,onUploaded:null,templateData:{name:"",desc:""}}},watch:{accept:function(t){var e=this;this.uploadObject=new d({id:this.$el,isAddUploadFile:this.auto,filters:this.accept,callback:function(t){e.$emit("uploadSuccess",t),"function"===typeof e.onUploaded&&e.onUploaded(t)}})}},beforeDestroy:function(){},mounted:function(){var t=this;this.uploadObject=new d({id:this.$el,isAddUploadFile:this.auto,filters:this.accept,callback:function(e){t.$emit("uploadSuccess",e),"function"===typeof t.onUploaded&&t.onUploaded(e)}}),this.ema.bind("saveTemplate",(function(){t.options=null,t.onUploaded=null,t.getImageDataByDom(document.querySelector(t.templateElement),(function(e){t.uploadImg(e)}))}))},methods:{upload:function(t,e,r){var n=this;this.options=e||null,this.onUploaded=r||null,t=t||document.querySelector(this.templateElement),this.getImageDataByDom(t,(function(t){n.uploadImg(t)}))},uploadImg:function(t){var e="ymm"+(new Date).getTime()+".png",r=this,n=new window.File([o["c"].getBlobBydataURI(t,"image/png")],e,{type:"image/png"});r.uploadObject.uploader.addFile(n),r.uploadObject.send()},getImageDataByDom:function(t,e){o["c"].html2canvas(t,this.h2c).then((function(t){var r=t.toDataURL();e&&e(r)}))}}},m=f,h=r("2877"),v=Object(h["a"])(m,n,a,!1,null,"2bff0db8",null);e["a"]=v.exports},e2b5:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{},[t.info.role<=1?e("div",{staticClass:"panel panel-default"},[e("div",{staticClass:"panel-heading"},[t._v("\n      添加用户到组\n    ")]),e("div",{staticClass:"panel-body"},[e("p",{staticClass:"light"},[t._v("\n        该组的用户能访问该组的所有项目\n      ")]),e("div",{staticClass:"new-group-member-holder"},[e("el-form",{attrs:{"label-width":"80px"}},[e("el-form-item",{attrs:{label:"账号"}},[e("el-select",{staticClass:"searchUser",attrs:{multiple:"",filterable:"",remote:"",placeholder:"请输入关键词","remote-method":t.querySearchAsync},model:{value:t.req.userId,callback:function(e){t.$set(t.req,"userId",e)},expression:"req.userId"}},t._l(t.searchUsers,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name+t.email,value:t.id}})})),1)],1),e("el-form-item",{attrs:{label:"权限"}},[e("el-select",{attrs:{placeholder:"请选择"},model:{value:t.req.role,callback:function(e){t.$set(t.req,"role",e)},expression:"req.role"}},t._l(t.Metadata.groupPower,(function(t,r){return e("el-option",{key:r,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary",disabled:!t.req.role||!t.hasAddUser},on:{click:t.onSubmit}},[t._v("添加用户到组")])],1)],1)],1)])]):t._e(),e("div",{staticClass:"panel panel-default"},[e("div",{staticClass:"panel-heading"},[e("strong",[t._v(t._s(t.info.name))]),t._v("\n      组 存在用户\n      "),e("span",{staticClass:"badge"},[t._v(t._s(t.users.length))]),e("div",{staticClass:"controls"})]),e("ul",{staticClass:"content-list"},t._l(t.users,(function(r,n){return e("li",{key:n,staticClass:"group_member js-toggle-container"},[e("div",{staticClass:"controls"},[t.canLeave||r.userId!=t.userInfo.userId?[t.info.role<=1?e("el-dropdown",{on:{command:t.handleCommand}},[e("span",{staticClass:"el-dropdown-link"},[t._v("\n                "+t._s(t._f("groupRole")(r.role))+" "),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.Metadata.groupPower,(function(n){return e("el-dropdown-item",{key:n.value,attrs:{trigger:"click",command:n.value+","+r.userId}},[t._v(t._s(n.label)+"\n                ")])})),1)],1):[t._v("\n              "+t._s(t._f("groupRole")(r.role))+"\n            ")]]:[t._v("\n            "+t._s(t._f("groupRole")(r.role))+"\n          ")],r.userId===t.userInfo.userId&&t.canLeave?e("a",{staticClass:"btn btn-remove",on:{click:function(e){return t.remove(r,!0)}}},[t._v("离开")]):t._e(),r.userId!=t.userInfo.userId&&t.info.role<=1?e("a",{staticClass:"btn btn-remove",on:{click:function(e){return t.remove(r)}}},[t._v("移除")]):t._e()],2),e("span",{staticClass:"list-item-name"},[e("img",{staticClass:"avatar s40",attrs:{alt:"",src:t._f("defaultHeader")(r.photo)}}),e("strong",[e("router-link",{attrs:{to:{path:"/user",query:{id:r.userId}}}},[t._v(t._s(r.name))])],1),r.userId===t.userInfo.userId?e("span",{staticClass:"label label-success"},[t._v("当前用户")]):t._e(),e("div",{staticClass:"cgray"},[t._v(t._s(r.email))])])])})),0)])])},a=[],o=r("f458"),i=r("c455"),s=r("8f20"),l=r("5880"),c=r("8bbf"),u=r.n(c);u.a.component("my-item-zh",{functional:!0,render:function(t,e){return t("li",e.data,[t(s["a"],{props:{item:e.props.item}})])},props:{item:{type:Object,required:!0}}});var d={mixins:[o["a"]],components:{UserItem:s["a"]},name:"groups_members",props:{id:""},data:function(){return{searchUsers:[],info:{},req:{groupId:"",role:"",userId:[]},users:[]}},computed:Object(l["mapState"])({Metadata:function(t){return t.Metadata},canLeave:function(){var t=this,e=0;return this.users.forEach((function(r){console.log(r.userId,t.userInfo.userId),r.userId!=t.userInfo.userId&&1==r.role&&e++})),e>0},hasAddUser:function(){return this.req.userId.length>0}}),mounted:function(){this.req.groupId=this.$route.query.id,this.loadData()},methods:{querySearchAsync:function(t,e){var r=this;t&&Object(i["a"])({url:"users/search",method:"get",params:{key:t}}).then((function(t){var e=r.pretreatmentList(t.data.data);r.searchUsers=e.filter((function(t){return t.id!=r.userInfo.userId}))})).catch((function(){}))},pretreatmentList:function(t){var e=[];return t.forEach((function(t){e.push({value:t.name,email:t.email,name:t.name,photo:t.photo,id:t.id})})),e},loadData:function(){var t=this;Object(i["a"])({url:"project/groupuser",method:"get",params:{count:100,id:this.req.groupId,start:0}}).then((function(e){t.users=e.data.data||[]})),Object(i["a"])({url:"project/groupinfo",method:"get",params:{id:this.info.id||this.req.groupId}}).then((function(e){t.info=e.data.data}))},onSubmit:function(){var t=this;this.req.groupId=this.req.groupId+"",Object(i["a"])({url:"project/groupuser",method:"post",data:this.req}).then((function(e){t.$message("添加成功"),t.loadData()})).catch((function(){}))},handleCommand:function(t){var e=this,r=t.split(",")[0],n=t.split(",")[1];Object(i["a"])({url:"project/groupuser",method:"put",data:{groupId:this.req.groupId,role:r,userId:n}}).then((function(t){e.$message("修改成功"),e.loadData()})).catch((function(){}))},remove:function(t,e){var r=this;Object(i["a"])({url:"project/groupuser",method:"delete",data:{groupId:this.req.groupId+"",userId:t.userId}}).then((function(e){r.$message("删除成功"),t.userId===r.userInfo.userId?r.$router.push({path:"/dashboard/groups"}):r.loadData()})).catch((function(){}))}}},p=d,f=(r("2480"),r("2877")),m=Object(f["a"])(p,n,a,!1,null,"3cc4b124",null);e["default"]=m.exports},ee73:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-wrapper page-with-layout-nav"},[e("div",{staticClass:"flash-container flash-container-page"}),e("div",{staticClass:"container-fluid container-limited"},[e("div",{staticClass:"content"},[e("div",{staticClass:"top-area"},[e("el-tabs",{staticClass:"nav-links",attrs:{"active-name":t.activeName},on:{"tab-click":t.tabHandleClick}},[e("el-tab-pane",{attrs:{label:"信 息",name:"info"}}),t.info.id?e("el-tab-pane",{attrs:{label:"成 员",name:"member"}}):t._e(),t.info.id?e("el-tab-pane",{attrs:{label:"项 目",name:"project"}}):t._e(),e("el-tab-pane",{attrs:{label:"统计",name:"report"}}),t.info.id&&t.info.role<=1?e("el-tab-pane",{attrs:{label:"设 置",name:"setting"}}):t._e()],1)],1),"info"==t.activeName?e("div",{staticClass:"group-members-page prepend-top-default"},[e("div",{staticClass:"panel panel-default prepend-top-default"},[e("div",{staticClass:"panel-heading"},[t._v("\n            基本信息\n          ")]),e("div",{staticClass:"panel-body"},[t.info.id?e("el-form",{ref:"form",attrs:{model:t.info,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"图标"}},[e("div",{staticClass:"headIcon"},[e("img",{attrs:{src:t._f("defaultGroup")(t.info.logo)}})])]),e("el-form-item",{attrs:{label:"名称",prop:"name"}},[e("el-input",{attrs:{placeholder:"名称",disabled:!0},model:{value:t.info.name,callback:function(e){t.$set(t.info,"name",e)},expression:"info.name"}})],1),e("el-form-item",{attrs:{label:"描述",prop:"description"}},[e("el-input",{attrs:{disabled:!0,type:"textarea"},model:{value:t.info.description,callback:function(e){t.$set(t.info,"description",e)},expression:"info.description"}})],1)],1):e("div",[t._m(0)])],1)]),e("el-alert",{staticClass:"tipWarp",attrs:{title:"项目组描述",type:"info"}},[e("div",{domProps:{innerHTML:t._s(t.groupMd)}})])],1):t._e(),"member"==t.activeName?e("div",{staticClass:"group-members-page prepend-top-default"},[t.info.id?e("members",{attrs:{id:t.info.id}}):t._e()],1):t._e(),"report"===t.activeName?e("div",{staticClass:"report"},[e("report",{attrs:{"group-id":t.groupId}})],1):t._e(),"project"==t.activeName?e("div",{staticClass:"projects-list-holder"},[t.hasData?e("ul",{staticClass:"projects-list content-list"},t._l(t.projects,(function(r){return e("router-link",{key:r.id,staticClass:"project-row",attrs:{to:{path:"/project",query:{id:r.id}},tag:"li"}},[e("div",{staticClass:"title"},[e("div",{staticClass:"project"},[e("div",{staticClass:"dash-project-avatar"},[e("div",{staticClass:"avatar project-avatar s40 identicon"},[e("img",{staticClass:"avatar project-avatar s40",attrs:{src:t._f("defaultProject")(r.logo)}})])]),e("span",{staticClass:"project-full-name"},[e("router-link",{staticClass:"namespace-name",attrs:{tag:"span",to:{path:"/user",query:{id:r.creatorId}}}},[t._v("\n                  "+t._s(r.creatorName)+"\n                  /\n                  ")]),e("router-link",{staticClass:"project-name filter-title",attrs:{tag:"span",to:{path:"/project",query:{id:r.id}}}},[t._v("\n                  "+t._s(r.projectName)+"\n                  ")])],1)])]),e("div",{staticClass:"description"},[e("p",[t._v(t._s(r.description))])])])})),1):e("div",[e("div",{staticClass:"blank-state"},[t._m(1),e("h3",{staticClass:"blank-state-title"},[e("router-link",{attrs:{to:{path:"/projects/new"}}},[e("el-button",{attrs:{type:"primary"}},[t._v("添加项目")])],1)],1)])])]):t._e(),"setting"==t.activeName?e("div",[e("div",{staticClass:"panel panel-default prepend-top-default"},[e("div",{staticClass:"panel-heading"},[t._v("\n            基本设置\n          ")]),e("div",{staticClass:"panel-body"},[e("c-new",{attrs:{"on-success":t.addGroupSuccess,id:t.info.id}})],1)]),e("div",{staticClass:"panel panel-danger"},[e("div",{staticClass:"panel-heading"},[t._v("删除团队")]),e("div",{staticClass:"panel-body"},[t._m(2),e("div",{staticClass:"form-actions"},[e("a",{staticClass:"btn btn-remove",attrs:{rel:"nofollow"},on:{click:t.remove}},[t._v("移除团队")])])])])]):t._e()])])])},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"blank-state"},[e("div",{staticClass:"blank-state-icon"},[e("i",{staticClass:"ifont icon-empty"}),e("span",[t._v("你无权访问该组信息")])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"blank-state-icon"},[e("i",{staticClass:"ifont icon-empty"}),e("span",[t._v("暂无项目")])])},function(){var t=this,e=t._self._c;return e("p",[t._v("\n              删除团队会导致该团队的项目全部被删除\n              "),e("br"),e("strong",[t._v("移除团队后不能回退，确定移除团队")])])}],o=r("f458"),i=r("c455"),s=r("e2b5"),l=r("8447"),c=r("9ac9"),u=r("85e6"),d={mixins:[o["a"]],components:{Members:s["default"],CNew:l["default"],Report:c["default"]},name:"groups_index",data:function(){return{info:{},projects:[],activeName:"info",groupId:this.$route.query.id,groupMd:u}},mounted:function(){this.getDetail()},watch:{},computed:{hasData:function(){return this.projects.length>0}},methods:{addGroupSuccess:function(t){t&&this.$router.push({path:"/dashboard/groups"})},tabHandleClick:function(t){this.activeName=t.name,"project"==t.name&&this.getProjects()},getProjects:function(){var t=this;Object(i["a"])({url:"project/groupproject",method:"get",params:{count:100,groupId:this.$route.query.id,start:0}}).then((function(e){t.projects=e.data.data})).catch((function(){}))},getDetail:function(t){var e=this;Object(i["a"])({url:"project/groupinfo",method:"get",params:{id:this.$route.query.id}}).then((function(r){e.info=r.data.data,t()})).catch((function(){}))},remove:function(){var t=this;this.$confirm("此操作将永久删除该团队和团队下面的项目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["a"])({url:"project/group",method:"delete",data:{id:t.$route.query.id-0}}).then((function(){t.$message("删除成功"),t.$router.push({path:"/dashboard/groups"})})).catch((function(){}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},p=d,f=r("2877"),m=Object(f["a"])(p,n,a,!1,null,null,null);e["default"]=m.exports}}]);