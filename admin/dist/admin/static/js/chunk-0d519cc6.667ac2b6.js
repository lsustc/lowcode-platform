(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d519cc6"],{"0320":function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.title,visible:t.Visible},on:{"update:visible":function(e){t.Visible=e},close:t.close}},[e("div",{staticClass:"content"},[e("el-form",{ref:"ruleForm",attrs:{"label-width":"80px",model:t.form,rules:t.rules}},[e("div",{staticClass:"base"},[e("h4",[t._v("基础信息")]),e("el-form-item",{attrs:{label:"所属项目",prop:"projectId"}},[e("el-select",{staticClass:"projectSelect",attrs:{placeholder:"请选择"},model:{value:t.form.projectId,callback:function(e){t.$set(t.form,"projectId",e)},expression:"form.projectId"}},t._l(t.myProjects,(function(o){return e("el-option",{key:o.id,attrs:{label:o.groupName+"/"+o.projectName,value:o.id}},[e("span",{staticStyle:{float:"left"}},[t._v(t._s(o.groupName+"/"+o.projectName))])])})),1)],1),e("el-row",{attrs:{type:"flex",gutter:0}},[e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{label:"页面标题",prop:"name"}},[e("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)],1),e("el-form-item",{attrs:{label:"描述",prop:"desc"}},[e("el-input",{attrs:{type:"textarea",placeholder:"该页面的简要描述1-50个字",minlength:1,maxlength:50},model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc","string"===typeof e?e.trim():e)},expression:"form.desc"}})],1),e("el-form-item",{attrs:{label:"标签"}},[e("tags",{attrs:{"can-add":!0,"category-id":1,tags:t.form.tags},on:{"update:tags":function(e){return t.$set(t.form,"tags",e)}}})],1),"fork"!=t.type?e("el-form-item",{attrs:{label:"设为模板"}},[e("el-radio-group",{model:{value:t.form.visibilitylevel,callback:function(e){t.$set(t.form,"visibilitylevel",e)},expression:"form.visibilitylevel"}},[e("el-radio",{attrs:{label:0}},[t._v("否")]),e("el-radio",{attrs:{label:1}},[t._v("是")])],1)],1):t._e()],1)])],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.close}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addPageInfo("ruleForm")}}},[t._v("确定添加，编辑详情")])],1)])},a=[],i=o("2747"),s=o("c455"),l=o("3855"),c={mixins:[i["a"]],name:"DCopyPage",components:{Tags:l["a"]},data:function(){return{Visible:!0,formLabelWidth:"150px",myProjects:[],form:{name:"",desc:"",visibilitylevel:0,projectId:null,tags:[],type:"0",content:""},source:{},rules:{projectId:[{required:!0,message:"请选择所属项目",trigger:"change"}],name:[{required:!0,message:"请输入页面标题",trigger:"blur"}],desc:[{required:!1,message:"请输入描述内容",trigger:"blur"}]}}},watch:{},mounted:function(){this.getGrops(),this.form.visibilitylevel=0},methods:{getGrops:function(){var t=this;Object(s["a"])({url:"project/project",method:"get",needLoading:!0,params:{count:100,start:0}}).then((function(e){var o=e.data.data;t.myProjects=o,0==o.length&&t.$confirm("你还没有任何项目，添加页面前需要先添加项目：前往添加项目","提示",{type:"warning"}).then((function(){t.close(),t.$router.push({path:"/projects/new"})})).catch((function(){t.$message("已取消")}))})).catch((function(){}))},updateFork:function(t){var e=this;Object(s["a"])({url:"editor/pages/update-fork",method:"post",trimNull:!1,data:{projectId:this.source.projectId,id:this.source.id}}).then((function(t){e.ema.fire("dashboard_featured.pageAddSuccess")}))},addPageInfo:function(t){var e=this,o=this;this.$refs[t].validate((function(t){t&&Object(s["a"])({url:"editor/pages/save",method:"post",needLoading:!0,trimNull:!1,data:o.form}).then((function(t){o.$message({showClose:!0,message:"添加成功",type:"success"}),"fork"===o.type&&(e.updateFork(),e.$router.push({path:"/project",query:{id:o.form.projectId}})),e.ema.fire("projects_cdoc.pageAddSuccess"),o.close()}))}))}}},r=c,u=(o("9a09"),o("2877")),d=Object(u["a"])(r,n,a,!1,null,"f649c238",null);e["default"]=d.exports},"0923":function(t,e,o){"use strict";o("9b1c")},2747:function(t,e,o){"use strict";e["a"]={replace:!0,data:function(){return{title:"",size:"small",Visible:!0}},beforeCreated:function(){console.log("dialog---beforeCreated",this.$options.name)},created:function(){this.ema=window.EMA.getProxy(),console.log("dialog---created",this.$options.name)},beforeMount:function(){console.log("dialog---beforeMount",this.$options.name)},mounted:function(){console.log("dialog---mounted",this.$options.name)},beforeUpdate:function(){console.log("dialog---beforeUpdate",this.$options.name)},updated:function(){console.log("dialog---updated",this.$options.name)},activated:function(){console.log("dialog---activated",this.$options.name)},deactivated:function(){console.log("dialog---deactivated",this.$options.name)},beforDestroy:function(){console.log("dialog---beforDestroy",this.$options.name)},destroyed:function(){this.ema.dispose(),console.log("dialog---destroyed",this.$options.name)},methods:{bindEvent:function(t,e){this.$options.name||console.warn("绑定事件的组件不存在组件名称",t),this.ema.bind("".concat(this.$options.name,".").concat(t),e)},openDialog:function(t){this.ema.fire("Dialogs.push",t)},close:function(){console.log("close"),this.ema.fire("Dialogs.close",this.$options.name)}}}},3855:function(t,e,o){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"editerTags"},[e("span",{staticClass:"tagWarp"},[t._l(t.tags,(function(o,n){return e("el-tag",{key:n,staticClass:"tag",attrs:{closable:!0,"close-transition":!1},on:{close:function(e){return t.handleClose(n,o)}}},[e("i",{staticClass:"ifont icon-tag"}),t._v(t._s(o.name)+"\n    ")])})),t.inputVisible?e("el-autocomplete",{attrs:{size:"mini","value-key":"name","fetch-suggestions":t.querySearchAsync,maxlength:10,minlength:1,placeholder:"请输入内容"},on:{select:t.handleSelect},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm.apply(null,arguments)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):t._e(),t.canAdd&&t.inputBtnVisible?e("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(e){t.inputVisible=!0,t.inputBtnVisible=!1}}},[t._v("+新标签")]):t._e()],2),e("div",[e("h4",[t._v("可快速选标签列表")]),t._l(t.canSelectTags,(function(o,n){return e("el-tag",{key:n,staticClass:"tag",nativeOn:{click:function(e){return t.selectTag(o)}}},[e("i",{staticClass:"ifont icon-tag"}),t._v(t._s(o.name)+"\n    ")])}))],2)])},a=[],i=o("ed03"),s=o("c455"),l={mixins:[i["a"]],name:"UploadImage",components:{},props:{tags:{type:Array,default:function(t){return[]}},categoryId:{type:Number},canAdd:{type:Boolean,default:!1}},data:function(){return{canSelectTags:[],inputVisible:!1,inputBtnVisible:!0,inputValue:""}},watch:{},beforeDestroy:function(){},mounted:function(){this.categoryId&&this.loadTags()},methods:{querySearchAsync:function(t,e){Object(s["a"])({url:"editor/tags/list",data:{categoryId:this.categoryId,name:t},method:"post"}).then((function(t){var o=t.data.data;console.log(o),e(o)})).catch((function(t){}))},handleSelect:function(t){var e=this;this.selectTag(t),this.$nextTick((function(){e.inputValue=""}))},selectTag:function(t){var e=this.tags.find((function(e){if(e.id==t.id)return!0}));e||this.tags.push(t)},loadTags:function(t){var e=this;Object(s["a"])({url:"editor/tags/list",data:{categoryId:this.categoryId,name:""},method:"post"}).then((function(t){var o=t.data.data;e.canSelectTags=o})).catch((function(t){}))},handleInputConfirm:function(){var t=this,e=this.inputValue;e&&Object(s["a"])({url:"editor/tags/add",data:{categoryId:this.categoryId,name:e},method:"post"}).then((function(o){var n=o.data.data;t.selectTag({id:n.id,name:e}),t.inputVisible=!1,t.inputValue="",t.tags.length>2?t.inputBtnVisible=!1:t.inputBtnVisible=!0})).catch((function(e){t.$message("标签添加失败")}))},handleClose:function(t,e){this.tags.splice(this.tags.indexOf(t),1),this.tags.length>2?this.inputBtnVisible=!1:this.inputBtnVisible=!0}}},c=l,r=(o("0923"),o("2877")),u=Object(r["a"])(c,n,a,!1,null,"38bfb3ee",null);e["a"]=u.exports},"9a09":function(t,e,o){"use strict";o("abd2")},"9b1c":function(t,e,o){},abd2:function(t,e,o){}}]);